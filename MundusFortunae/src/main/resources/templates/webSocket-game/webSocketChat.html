<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title th:text="${title} ?: 'Template'"></title>

	<!-- ê³µí†µ CSS -->
  <th:block th:replace="~{fragments/external :: bootstrap_cdn_block}"></th:block>
  <link rel="stylesheet" th:href="@{/header-footer/css/header.css}" />
  <link rel="stylesheet" th:href="@{/header-footer/css/footer.css}" />
  <link rel="stylesheet" th:href="@{/home/css/home.css}">

	<script th:inline="javascript">
	  const contextPath = /*[[@{/}]]*/ '';
	  let socket;
	  
	  document.addEventListener('DOMContentLoaded', () => {
		  
			openSocket();
			
			
		}); //DOMContentLoaded END
	  
	  function openSocket(){
			
			//localhostëŠ” ë‚´ pcê¸°ì¤€, ë‹¤ë¥¸ ê¸°ê¸°ì ‘ì†ì„ ìœ„í•´ ê³µì¸ipì£¼ì†Œë¥¼ ë„£ì–´ì¤˜ì•¼í•¨ 
			const host = window.location.host;
		  socket = new WebSocket("ws://" + host + "/mf/playWebSocket");
	
	    socket.onopen = () => { 
	    	//ì„œë²„ì™€ websocket ì—°ê²°ë¨ 
	    	console.log("ì„œë²„ì™€ ì—°ê²°ë¨");
     		document.getElementById("log").value += "ì„œë²„ì™€ ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤.\n";
	    };
	
	    socket.onmessage = (event) => {
	    	console.log(event);
	    	const data = JSON.parse(event.data); // ì„œë²„ê°€ ë³´ë‚¸ ë©”ì‹œì§€, JSON í˜•íƒœë¡œ ë°›ê¸°
	    	
				let time = new Date();
	    	let currentTime = " ["+time.getHours()+":"+time.getMinutes()+":"+time.getSeconds()+"] ";
	    	// event ìì²´ëŠ” MessageEventê³ , event.dataê°€ ì‹¤ì œ í˜ì´ë¡œë“œ(ë¬¸ìì—´) (in username, msg ë“±ë“±)
	      document.getElementById("log").value += "ğŸ“© " + data.username + " : " + data.msg + currentTime + "\n";
	    };
	
	    socket.onclose = () => {
	       document.getElementById("log").value += "ì—°ê²°ì´ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.\n";
	    };
	    
	  } //openSocket() END
	  
	  function sendMsg() {
			const username = document.querySelector('#username').value;
	    const msg = document.getElementById("msg").value;
	    
	    //socket.send(msg); //ì²˜ìŒì—ëŠ” ë‹¨ìˆœí•œ â€œë¬¸ìì—´ ì±„íŒ…â€ì´ì—ˆê¸° ë•Œë¬¸ì— socket.send(msg)ë¡œ ì¶©ë¶„í–ˆì§€ë§Œ...
	    
	    //socketì€ ë§¤ê°œë³€ìˆ˜ í•˜ë‚˜ë§Œ ë°›ì„ ìˆ˜ ìˆìŒ. JSONìœ¼ë¡œ ë¬¶ì–´ì„œ ë³´ë‚´ê¸° 
	    const sendData = JSON.stringify({username, msg});
	    
	    socket.send(sendData);
	    
	    document.getElementById("msg").value = ""; //ë©”ì‹œì§€ì¹¸ ì´ˆê¸°í™” 
		} //sendMsg() END 
	  
	</script>	
</head>
<body>
	<!-- ê³µí†µ í—¤ë” -->
	<div th:replace="~{fragments/header :: header}"></div>

	<div class="d-flex justify-content-center main-content">
		<div class="card p-4 mt-5">
			<main>
			<!-- 
			WebSocketì´ë‚˜ HTTP body ì „ì†¡ì—ì„œëŠ”
			ë¬¸ìì—´ì´ë‚˜ ë°”ì´ë„ˆë¦¬ ë°ì´í„°ë§Œ ë³´ë‚¼ ìˆ˜ ìˆë‹¤.
			 -->
			<h2>ğŸ’¬ ì‹¤ì‹œê°„ ì±„íŒ…</h2>
			<textarea id="log" rows="15" cols="60" readonly></textarea><br>
			<input type="text" id="username" size="10" placeholder="ì•„ì´ë””">
			<input type="text" id="msg" size="50" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
			<button onclick="sendMsg()">ë³´ë‚´ê¸°</button>
			
			</main>
		</div>
	</div>
  
  <footer class="footer-content bg-light py-4 mt-5">
    <div class="container text-center text-muted">
      <p>&copy; 2024 MundusFortunae. All rights reserved.</p>
    </div>
  </footer>

</body>
</html>

<!-- 
ì£¼ìš” ë¶€íŠ¸ìŠ¤íŠ¸ë© í´ë˜ìŠ¤ ì •ë¦¬:

1. ë ˆì´ì•„ì›ƒ
- d-flex: flexbox ë ˆì´ì•„ì›ƒ ì‚¬ìš©
- justify-content-between: ì–‘ìª½ ë ì •ë ¬
- justify-content-center: ê°€ìš´ë° ì •ë ¬
- justify-content-around: ì•½ê°„ ì¤‘ì•™ ê· ë“± ì •ë ¬
- justify-content-evenly: ì „ì²´ì  ê· ë“± ì •ë ¬
- justify-content-start: ì™¼ìª½ ì •ë ¬
- justify-content-end: ì˜¤ë¥¸ìª½ ì •ë ¬
- align-items-center: ì„¸ë¡œ ì¤‘ì•™ ì •ë ¬
- align-items-start: ì„¸ë¡œ ì‹œì‘ì  ì •ë ¬
- flex-grow-1: ë‚¨ì€ ê³µê°„ ëª¨ë‘ ì°¨ì§€

2. ê°„ê²©
- p-3: íŒ¨ë”© (padding) ì ìš©
- py-3: ìœ„ì•„ë˜ íŒ¨ë”©
- mb-2: ì•„ë˜ ë§ˆì§„ (margin-bottom)
- mb-4: ì•„ë˜ ë§ˆì§„ (ë” í° ê°’)
- my-5: ìœ„ì•„ë˜ ë§ˆì§„

3. í…Œë‘ë¦¬ ë° ëª¨ì–‘
- border-bottom: ì•„ë˜ í…Œë‘ë¦¬
- rounded: ë‘¥ê·¼ ëª¨ì„œë¦¬
- shadow-sm: ì‘ì€ ê·¸ë¦¼ì íš¨ê³¼

4. í…ìŠ¤íŠ¸
- fw-bold: ê¸€ì”¨ êµµê²Œ
- text-muted: íšŒìƒ‰ í…ìŠ¤íŠ¸
- text-end: ì˜¤ë¥¸ìª½ ì •ë ¬
- text-dark: ì–´ë‘ìš´ ê¸€ì”¨ìƒ‰
- small: ì‘ì€ ê¸€ì”¨

5. ìƒ‰ìƒ
- bg-primary: íŒŒë€ìƒ‰ ë°°ê²½
- bg-warning: ë…¸ë€ìƒ‰ ë°°ê²½
- notice-bg: íšŒìƒ‰ ë°°ê²½ (ì»¤ìŠ¤í…€)

6. ì»´í¬ë„ŒíŠ¸
- badge: ë°°ì§€ ìŠ¤íƒ€ì¼
- card: ì¹´ë“œ ì»¨í…Œì´ë„ˆ
- card-body: ì¹´ë“œ ë‚´ìš©
- pagination: í˜ì´ì§€ë„¤ì´ì…˜
- page-item: í˜ì´ì§€ í•­ëª©
- page-link: í˜ì´ì§€ ë§í¬
- input-group: ì…ë ¥ í•„ë“œ ê·¸ë£¹
- form-control: ì…ë ¥ í•„ë“œ
- btn: ë²„íŠ¼
- btn-outline-secondary: íšŒìƒ‰ í…Œë‘ë¦¬ ë²„íŠ¼

7. ìƒíƒœ
- active: í™œì„±í™” ìƒíƒœ
- disabled: ë¹„í™œì„±í™” ìƒíƒœ
- hover: ë§ˆìš°ìŠ¤ ì˜¤ë²„ íš¨ê³¼ (CSS)
-->

<!-- 
=====================================================
  Thymeleaf ìì£¼ ì‚¬ìš©í•˜ëŠ” ë¬¸ë²• ì •ë¦¬
=====================================================

1. ë³€ìˆ˜ í‘œí˜„ì‹
   - ${ë³€ìˆ˜ëª…} : ì¼ë°˜ ë³€ìˆ˜ ì¶œë ¥
   - ${user.name} : ê°ì²´ ì†ì„± ì ‘ê·¼
   - ${list[0]} : ë¦¬ìŠ¤íŠ¸ ì¸ë±ìŠ¤ ì ‘ê·¼
   - ${map['key']} : ë§µ ê°’ ì ‘ê·¼

2. ì„ íƒ ë³€ìˆ˜ í‘œí˜„ì‹
   - *{property} : ì„ íƒëœ ê°ì²´ì˜ ì†ì„±
   ì˜ˆ) <div th:object="${user}">
         <span th:text="*{name}"></span>
       </div>

3. URL í‘œí˜„ì‹
   - @{/path} : ì»¨í…ìŠ¤íŠ¸ ê²½ë¡œ ìë™ ì¶”ê°€
   - @{/user/{id}(id=${user.id})} : ê²½ë¡œ ë³€ìˆ˜
   - @{/search(q=${query},page=${page})} : ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°

4. ë©”ì‹œì§€ í‘œí˜„ì‹
   - #{message.key} : properties íŒŒì¼ì˜ ë©”ì‹œì§€

5. ì¡°ê±´ë¬¸
   - th:if="${condition}" : ì¡°ê±´ì´ trueì¼ ë•Œ ë Œë”ë§
   - th:unless="${condition}" : ì¡°ê±´ì´ falseì¼ ë•Œ ë Œë”ë§
   - th:switch="${value}" / th:case="ê°’" : switch ë¬¸

6. ë°˜ë³µë¬¸
   - th:each="item : ${list}" : ë¦¬ìŠ¤íŠ¸ ë°˜ë³µ
   - th:each="item, stat : ${list}" : ìƒíƒœ ë³€ìˆ˜ í¬í•¨
     * stat.index : 0ë¶€í„° ì‹œì‘í•˜ëŠ” ì¸ë±ìŠ¤
     * stat.count : 1ë¶€í„° ì‹œì‘í•˜ëŠ” ì¹´ìš´íŠ¸
     * stat.size : ì „ì²´ í¬ê¸°
     * stat.first : ì²« ë²ˆì§¸ ì—¬ë¶€
     * stat.last : ë§ˆì§€ë§‰ ì—¬ë¶€
     * stat.odd / stat.even : í™€ìˆ˜/ì§ìˆ˜ ì—¬ë¶€

7. ì†ì„± ì„¤ì •
   - th:text="${value}" : í…ìŠ¤íŠ¸ ì„¤ì • (HTML ì´ìŠ¤ì¼€ì´í”„)
   - th:utext="${value}" : HTML íƒœê·¸ í¬í•¨ í…ìŠ¤íŠ¸
   - th:href="@{/path}" : href ì†ì„± ì„¤ì •
   - th:src="@{/images/logo.png}" : src ì†ì„± ì„¤ì •
   - th:value="${value}" : value ì†ì„± ì„¤ì •
   - th:attr="data-id=${id}, data-name=${name}" : ì—¬ëŸ¬ ì†ì„± ì„¤ì •

8. í´ë˜ìŠ¤ ë° ìŠ¤íƒ€ì¼
   - th:class="${condition} ? 'active' : ''" : ì¡°ê±´ë¶€ í´ë˜ìŠ¤
   - th:classappend="${condition} ? 'active'" : í´ë˜ìŠ¤ ì¶”ê°€
   - th:style="'color:' + ${color}" : ì¸ë¼ì¸ ìŠ¤íƒ€ì¼

9. Fragment (ì¡°ê°)
   - th:fragment="ì´ë¦„" : ì¡°ê° ì •ì˜
   - th:replace="~{íŒŒì¼ëª… :: ì¡°ê°ëª…}" : ì¡°ê°ìœ¼ë¡œ ëŒ€ì²´
   - th:insert="~{íŒŒì¼ëª… :: ì¡°ê°ëª…}" : ì¡°ê° ì‚½ì…
   - th:block : ì‹¤ì œ íƒœê·¸ ì—†ì´ Thymeleaf ëª…ë ¹ë§Œ ì‚¬ìš©

10. ìœ í‹¸ë¦¬í‹° ê°ì²´
    - #temporals : ë‚ ì§œ/ì‹œê°„ í¬ë§·íŒ…
      ${#temporals.format(date, 'yyyy-MM-dd')}
    - #strings : ë¬¸ìì—´ ì²˜ë¦¬
      ${#strings.isEmpty(str)}
      ${#strings.substring(str, 0, 10)}
    - #numbers : ìˆ«ì í¬ë§·íŒ…
      ${#numbers.formatDecimal(num, 1, 2)}
    - #lists : ë¦¬ìŠ¤íŠ¸ ì²˜ë¦¬
      ${#lists.size(list)}
      ${#lists.isEmpty(list)}
    - #arrays : ë°°ì—´ ì²˜ë¦¬
    - #maps : ë§µ ì²˜ë¦¬

11. ì¡°ê±´ ì—°ì‚°ì
    - ${condition} ? 'yes' : 'no' : ì‚¼í•­ ì—°ì‚°ì
    - ${value} ?: 'default' : Elvis ì—°ì‚°ì (nullì´ë©´ ê¸°ë³¸ê°’)

12. Spring Security í†µí•©
    - sec:authorize="isAuthenticated()" : ì¸ì¦ ì—¬ë¶€
    - sec:authorize="hasRole('ADMIN')" : ê¶Œí•œ í™•ì¸
    - ${#authentication.principal.username} : ì‚¬ìš©ìëª…
    - ${#authentication.principal.authorities} : ê¶Œí•œ ëª©ë¡

13. Form ê´€ë ¨
    - th:object="${formObject}" : í¼ ê°ì²´ ë°”ì¸ë”©
    - th:field="*{ì†ì„±ëª…}" : ì…ë ¥ í•„ë“œ ë°”ì¸ë”© (id, name, value ìë™ ì„¤ì •)
    - th:errors="*{ì†ì„±ëª…}" : ìœ íš¨ì„± ê²€ì‚¬ ì˜¤ë¥˜ í‘œì‹œ

14. ì¸ë¼ì¸ í‘œí˜„ì‹
    - [[${ë³€ìˆ˜}]] : í…ìŠ¤íŠ¸ ì¸ë¼ì¸
    - [(${ë³€ìˆ˜})] : ì†ì„± ì¸ë¼ì¸
    - /*[[${ë³€ìˆ˜}]]*/ : JavaScript ì¸ë¼ì¸

15. ì£¼ì„
    - <!-- ì¼ë°˜ HTML ì£¼ì„ (ë Œë”ë§ë¨) -->
    - <!--/* Thymeleaf ì£¼ì„ (ë Œë”ë§ ì•ˆë¨) */-->
<!-- 
ì˜ˆì œ:
<div th:if="${not #lists.isEmpty(postList)}">
  <ul>
    <li th:each="post, stat : ${postList}" 
        th:class="${stat.odd} ? 'odd' : 'even'">
      <a th:href="@{/post/{id}(id=${post.id})}" 
         th:text="${post.title}">ì œëª©</a>
      <span th:text="${#temporals.format(post.createdAt, 'yyyy-MM-dd')}"></span>
    </li>
  </ul>
</div>

-->